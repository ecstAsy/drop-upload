{"version":3,"sources":["webpack:///../src/index.js","webpack:///./utils/directory.js","webpack:///./utils/tree.js","webpack:///./utils/Request.js","webpack:///./utils/index.js","webpack:///./components/PageLoading/index.css","webpack:///./components/PageLoading/index.js","webpack:///./components/ToastModal/index.css","webpack:///./components/ToastModal/index.js","webpack:///./components/PageToast/index.css","webpack:///./components/PageToast/index.js","webpack:///./components/DirectoryTree/index.css","webpack:///./components/DirectoryTree/index.js","webpack:///./routes/home/style.css","webpack:///./routes/home/index.js"],"names":["getHookState","index","type","options","currentComponent","currentHook","hooks","length","push","useState","initialState","reducer","init","hookState","currentIndex","_reducer","invokeOrReturn","nextValue","action","setState","useReducer","flushAfterPaintEffects","component","afterPaintEffects","sort","a","b","pop","forEach","invokeCleanup","invokeEffect","e","hook","comp","cleanup","arg","f","errorHandler","console","log","code","prevRaf","oldBeforeDiff","oldBeforeRender","oldAfterDiff","diffed","oldCommit","oldBeforeUnmount","unmount","vnode","c","requestAnimationFrame","callback","raf","done","clearTimeout","timeout","HAS_RAF","cancelAnimationFrame","setTimeout","commitQueue","some","filter","cb","hasErrored","s","Directory","entries","setValue","map","item","isDirectory","directoryReader","createReader","getAllEntries","file","fullPath","content","getValue","this","value","vs","Promise","resolve","entires","that","readEntries","results","concat","Array","prototype","slice","call","readDirectory","Videos","Images","Icons","findChildren","roots","values","children","parent","getTree","root","name","icon","split","join","itp","includes","match","findParent","findType","Request","url","params","method","data","reject","fetch","body","then","response","json","res","catch","error","FileValidated","files","valid","find","PageLoading","visible","class","style","ToastModal","password","onConfirm","className","onClick","PageToast","message","onClose","FileItem","row","TreeItem","key","DirectoryTree","trees","Home","isDrop","setIsDrop","isError","setIsError","dirs","setDirs","setTrees","loading","setLoading","setPassword","all","setModalProps","modalProps","setToastProps","toastProps","drop","onSubmit","form","FormData","append","i","onDrop","preventDefault","dataTransfer","items","webkitGetAsEntry","directories","getDirectoryInfo","getFileTree","ds","isFile","document","getElementById","click","onDragover","onDragStart","id","accept","multiple","onChange","fileList","target","Object","webkitdirectory","mozdirectort","placeholder","onBlur"],"mappings":"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","file":"route-home.chunk.40c86.js","sourcesContent":["import { options } from 'preact';\r\n\r\n/** @type {number} */\r\nlet currentIndex;\r\n\r\n/** @type {import('./internal').Component} */\r\nlet currentComponent;\r\n\r\n/** @type {number} */\r\nlet currentHook = 0;\r\n\r\n/** @type {Array<import('./internal').Component>} */\r\nlet afterPaintEffects = [];\r\n\r\nlet oldBeforeDiff = options._diff;\r\nlet oldBeforeRender = options._render;\r\nlet oldAfterDiff = options.diffed;\r\nlet oldCommit = options._commit;\r\nlet oldBeforeUnmount = options.unmount;\r\n\r\nconst RAF_TIMEOUT = 100;\r\nlet prevRaf;\r\n\r\noptions._diff = vnode => {\r\n\tcurrentComponent = null;\r\n\tif (oldBeforeDiff) oldBeforeDiff(vnode);\r\n};\r\n\r\noptions._render = vnode => {\r\n\tif (oldBeforeRender) oldBeforeRender(vnode);\r\n\r\n\tcurrentComponent = vnode._component;\r\n\tcurrentIndex = 0;\r\n\r\n\tconst hooks = currentComponent.__hooks;\r\n\tif (hooks) {\r\n\t\thooks._pendingEffects.forEach(invokeCleanup);\r\n\t\thooks._pendingEffects.forEach(invokeEffect);\r\n\t\thooks._pendingEffects = [];\r\n\t}\r\n};\r\n\r\noptions.diffed = vnode => {\r\n\tif (oldAfterDiff) oldAfterDiff(vnode);\r\n\r\n\tconst c = vnode._component;\r\n\tif (c && c.__hooks && c.__hooks._pendingEffects.length) {\r\n\t\tafterPaint(afterPaintEffects.push(c));\r\n\t}\r\n\tcurrentComponent = null;\r\n};\r\n\r\noptions._commit = (vnode, commitQueue) => {\r\n\tcommitQueue.some(component => {\r\n\t\ttry {\r\n\t\t\tcomponent._renderCallbacks.forEach(invokeCleanup);\r\n\t\t\tcomponent._renderCallbacks = component._renderCallbacks.filter(cb =>\r\n\t\t\t\tcb._value ? invokeEffect(cb) : true\r\n\t\t\t);\r\n\t\t} catch (e) {\r\n\t\t\tcommitQueue.some(c => {\r\n\t\t\t\tif (c._renderCallbacks) c._renderCallbacks = [];\r\n\t\t\t});\r\n\t\t\tcommitQueue = [];\r\n\t\t\toptions._catchError(e, component._vnode);\r\n\t\t}\r\n\t});\r\n\r\n\tif (oldCommit) oldCommit(vnode, commitQueue);\r\n};\r\n\r\noptions.unmount = vnode => {\r\n\tif (oldBeforeUnmount) oldBeforeUnmount(vnode);\r\n\r\n\tconst c = vnode._component;\r\n\tif (c && c.__hooks) {\r\n\t\tlet hasErrored;\r\n\t\tc.__hooks._list.forEach(s => {\r\n\t\t\ttry {\r\n\t\t\t\tinvokeCleanup(s);\r\n\t\t\t} catch (e) {\r\n\t\t\t\thasErrored = e;\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (hasErrored) options._catchError(hasErrored, c._vnode);\r\n\t}\r\n};\r\n\r\n/**\r\n * Get a hook's state from the currentComponent\r\n * @param {number} index The index of the hook to get\r\n * @param {number} type The index of the hook to get\r\n * @returns {any}\r\n */\r\nfunction getHookState(index, type) {\r\n\tif (options._hook) {\r\n\t\toptions._hook(currentComponent, index, currentHook || type);\r\n\t}\r\n\tcurrentHook = 0;\r\n\r\n\t// Largely inspired by:\r\n\t// * https://github.com/michael-klein/funcy.js/blob/f6be73468e6ec46b0ff5aa3cc4c9baf72a29025a/src/hooks/core_hooks.mjs\r\n\t// * https://github.com/michael-klein/funcy.js/blob/650beaa58c43c33a74820a3c98b3c7079cf2e333/src/renderer.mjs\r\n\t// Other implementations to look at:\r\n\t// * https://codesandbox.io/s/mnox05qp8\r\n\tconst hooks =\r\n\t\tcurrentComponent.__hooks ||\r\n\t\t(currentComponent.__hooks = {\r\n\t\t\t_list: [],\r\n\t\t\t_pendingEffects: []\r\n\t\t});\r\n\r\n\tif (index >= hooks._list.length) {\r\n\t\thooks._list.push({});\r\n\t}\r\n\treturn hooks._list[index];\r\n}\r\n\r\n/**\r\n * @param {import('./index').StateUpdater<any>} [initialState]\r\n */\r\nexport function useState(initialState) {\r\n\tcurrentHook = 1;\r\n\treturn useReducer(invokeOrReturn, initialState);\r\n}\r\n\r\n/**\r\n * @param {import('./index').Reducer<any, any>} reducer\r\n * @param {import('./index').StateUpdater<any>} initialState\r\n * @param {(initialState: any) => void} [init]\r\n * @returns {[ any, (state: any) => void ]}\r\n */\r\nexport function useReducer(reducer, initialState, init) {\r\n\t/** @type {import('./internal').ReducerHookState} */\r\n\tconst hookState = getHookState(currentIndex++, 2);\r\n\thookState._reducer = reducer;\r\n\tif (!hookState._component) {\r\n\t\thookState._value = [\r\n\t\t\t!init ? invokeOrReturn(undefined, initialState) : init(initialState),\r\n\r\n\t\t\taction => {\r\n\t\t\t\tconst nextValue = hookState._reducer(hookState._value[0], action);\r\n\t\t\t\tif (hookState._value[0] !== nextValue) {\r\n\t\t\t\t\thookState._value = [nextValue, hookState._value[1]];\r\n\t\t\t\t\thookState._component.setState({});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t];\r\n\r\n\t\thookState._component = currentComponent;\r\n\t}\r\n\r\n\treturn hookState._value;\r\n}\r\n\r\n/**\r\n * @param {import('./internal').Effect} callback\r\n * @param {any[]} args\r\n */\r\nexport function useEffect(callback, args) {\r\n\t/** @type {import('./internal').EffectHookState} */\r\n\tconst state = getHookState(currentIndex++, 3);\r\n\tif (!options._skipEffects && argsChanged(state._args, args)) {\r\n\t\tstate._value = callback;\r\n\t\tstate._args = args;\r\n\r\n\t\tcurrentComponent.__hooks._pendingEffects.push(state);\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {import('./internal').Effect} callback\r\n * @param {any[]} args\r\n */\r\nexport function useLayoutEffect(callback, args) {\r\n\t/** @type {import('./internal').EffectHookState} */\r\n\tconst state = getHookState(currentIndex++, 4);\r\n\tif (!options._skipEffects && argsChanged(state._args, args)) {\r\n\t\tstate._value = callback;\r\n\t\tstate._args = args;\r\n\r\n\t\tcurrentComponent._renderCallbacks.push(state);\r\n\t}\r\n}\r\n\r\nexport function useRef(initialValue) {\r\n\tcurrentHook = 5;\r\n\treturn useMemo(() => ({ current: initialValue }), []);\r\n}\r\n\r\n/**\r\n * @param {object} ref\r\n * @param {() => object} createHandle\r\n * @param {any[]} args\r\n */\r\nexport function useImperativeHandle(ref, createHandle, args) {\r\n\tcurrentHook = 6;\r\n\tuseLayoutEffect(\r\n\t\t() => {\r\n\t\t\tif (typeof ref == 'function') ref(createHandle());\r\n\t\t\telse if (ref) ref.current = createHandle();\r\n\t\t},\r\n\t\targs == null ? args : args.concat(ref)\r\n\t);\r\n}\r\n\r\n/**\r\n * @param {() => any} factory\r\n * @param {any[]} args\r\n */\r\nexport function useMemo(factory, args) {\r\n\t/** @type {import('./internal').MemoHookState} */\r\n\tconst state = getHookState(currentIndex++, 7);\r\n\tif (argsChanged(state._args, args)) {\r\n\t\tstate._value = factory();\r\n\t\tstate._args = args;\r\n\t\tstate._factory = factory;\r\n\t}\r\n\r\n\treturn state._value;\r\n}\r\n\r\n/**\r\n * @param {() => void} callback\r\n * @param {any[]} args\r\n */\r\nexport function useCallback(callback, args) {\r\n\tcurrentHook = 8;\r\n\treturn useMemo(() => callback, args);\r\n}\r\n\r\n/**\r\n * @param {import('./internal').PreactContext} context\r\n */\r\nexport function useContext(context) {\r\n\tconst provider = currentComponent.context[context._id];\r\n\t// We could skip this call here, but than we'd not call\r\n\t// `options._hook`. We need to do that in order to make\r\n\t// the devtools aware of this hook.\r\n\t/** @type {import('./internal').ContextHookState} */\r\n\tconst state = getHookState(currentIndex++, 9);\r\n\t// The devtools needs access to the context object to\r\n\t// be able to pull of the default value when no provider\r\n\t// is present in the tree.\r\n\tstate._context = context;\r\n\tif (!provider) return context._defaultValue;\r\n\t// This is probably not safe to convert to \"!\"\r\n\tif (state._value == null) {\r\n\t\tstate._value = true;\r\n\t\tprovider.sub(currentComponent);\r\n\t}\r\n\treturn provider.props.value;\r\n}\r\n\r\n/**\r\n * Display a custom label for a custom hook for the devtools panel\r\n * @type {<T>(value: T, cb?: (value: T) => string | number) => void}\r\n */\r\nexport function useDebugValue(value, formatter) {\r\n\tif (options.useDebugValue) {\r\n\t\toptions.useDebugValue(formatter ? formatter(value) : value);\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {(error: any) => void} cb\r\n */\r\nexport function useErrorBoundary(cb) {\r\n\t/** @type {import('./internal').ErrorBoundaryHookState} */\r\n\tconst state = getHookState(currentIndex++, 10);\r\n\tconst errState = useState();\r\n\tstate._value = cb;\r\n\tif (!currentComponent.componentDidCatch) {\r\n\t\tcurrentComponent.componentDidCatch = err => {\r\n\t\t\tif (state._value) state._value(err);\r\n\t\t\terrState[1](err);\r\n\t\t};\r\n\t}\r\n\treturn [\r\n\t\terrState[0],\r\n\t\t() => {\r\n\t\t\terrState[1](undefined);\r\n\t\t}\r\n\t];\r\n}\r\n\r\n/**\r\n * After paint effects consumer.\r\n */\r\nfunction flushAfterPaintEffects() {\r\n\tlet component;\r\n\t// sort the queue by depth (outermost to innermost)\r\n\tafterPaintEffects.sort((a, b) => a._vnode._depth - b._vnode._depth);\r\n\twhile (component = afterPaintEffects.pop()) {\r\n\t\tif (!component._parentDom) continue;\r\n\t\ttry {\r\n\t\t\tcomponent.__hooks._pendingEffects.forEach(invokeCleanup);\r\n\t\t\tcomponent.__hooks._pendingEffects.forEach(invokeEffect);\r\n\t\t\tcomponent.__hooks._pendingEffects = [];\r\n\t\t} catch (e) {\r\n\t\t\tcomponent.__hooks._pendingEffects = [];\r\n\t\t\toptions._catchError(e, component._vnode);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nlet HAS_RAF = typeof requestAnimationFrame == 'function';\r\n\r\n/**\r\n * Schedule a callback to be invoked after the browser has a chance to paint a new frame.\r\n * Do this by combining requestAnimationFrame (rAF) + setTimeout to invoke a callback after\r\n * the next browser frame.\r\n *\r\n * Also, schedule a timeout in parallel to the the rAF to ensure the callback is invoked\r\n * even if RAF doesn't fire (for example if the browser tab is not visible)\r\n *\r\n * @param {() => void} callback\r\n */\r\nfunction afterNextFrame(callback) {\r\n\tconst done = () => {\r\n\t\tclearTimeout(timeout);\r\n\t\tif (HAS_RAF) cancelAnimationFrame(raf);\r\n\t\tsetTimeout(callback);\r\n\t};\r\n\tconst timeout = setTimeout(done, RAF_TIMEOUT);\r\n\r\n\tlet raf;\r\n\tif (HAS_RAF) {\r\n\t\traf = requestAnimationFrame(done);\r\n\t}\r\n}\r\n\r\n// Note: if someone used options.debounceRendering = requestAnimationFrame,\r\n// then effects will ALWAYS run on the NEXT frame instead of the current one, incurring a ~16ms delay.\r\n// Perhaps this is not such a big deal.\r\n/**\r\n * Schedule afterPaintEffects flush after the browser paints\r\n * @param {number} newQueueLength\r\n */\r\nfunction afterPaint(newQueueLength) {\r\n\tif (newQueueLength === 1 || prevRaf !== options.requestAnimationFrame) {\r\n\t\tprevRaf = options.requestAnimationFrame;\r\n\t\t(prevRaf || afterNextFrame)(flushAfterPaintEffects);\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {import('./internal').EffectHookState} hook\r\n */\r\nfunction invokeCleanup(hook) {\r\n\t// A hook cleanup can introduce a call to render which creates a new root, this will call options.vnode\r\n\t// and move the currentComponent away.\r\n\tconst comp = currentComponent;\r\n\tlet cleanup = hook._cleanup;\r\n\tif (typeof cleanup == 'function') {\r\n\t\thook._cleanup = undefined;\r\n\t\tcleanup();\r\n\t}\r\n\tcurrentComponent = comp;\r\n}\r\n\r\n/**\r\n * Invoke a Hook's effect\r\n * @param {import('./internal').EffectHookState} hook\r\n */\r\nfunction invokeEffect(hook) {\r\n\t// A hook call can introduce a call to render which creates a new root, this will call options.vnode\r\n\t// and move the currentComponent away.\r\n\tconst comp = currentComponent;\r\n\thook._cleanup = hook._value();\r\n\tcurrentComponent = comp;\r\n}\r\n\r\n/**\r\n * @param {any[]} oldArgs\r\n * @param {any[]} newArgs\r\n */\r\nfunction argsChanged(oldArgs, newArgs) {\r\n\treturn (\r\n\t\t!oldArgs ||\r\n\t\toldArgs.length !== newArgs.length ||\r\n\t\tnewArgs.some((arg, index) => arg !== oldArgs[index])\r\n\t);\r\n}\r\n\r\nfunction invokeOrReturn(arg, f) {\r\n\treturn typeof f == 'function' ? f(arg) : f;\r\n}\r\n","/*\r\n * @Author: ecstAsy\r\n * @Date: 2022-01-06 16:58:12\r\n * @LastEditTime: 2022-01-17 17:52:45\r\n * @LastEditors: ecstAsy\r\n */\r\n\r\nfunction toArray(list) {\r\n  return Array.prototype.slice.call(list || [], 0);\r\n}\r\n\r\nfunction errorHandler(e) {\r\n  console.log(`FileSystem API error code: ${e.code}`);\r\n}\r\nclass Directory {\r\n  constructor() {\r\n    this.value = [];\r\n  }\r\n  // 赋值\r\n  setValue(vs) {\r\n    this.value = [...this.value, ...vs];\r\n  }\r\n  // 取值\r\n  getValue() {\r\n    return new Promise((resolve) => setTimeout(() => resolve(this.value), 500));\r\n  }\r\n  // 读取文件夹内容\r\n  readDirectory(entires) {\r\n    this.setValue(entires);\r\n    entires.map((item) => {\r\n      if (item.isDirectory) {\r\n        let directoryReader = item.createReader();\r\n        this.getAllEntries(directoryReader);\r\n      } else {\r\n        item.file(file => {\r\n           file.fullPath = item.fullPath\r\n           item.content = file;\r\n        })\r\n      }\r\n    });\r\n  }\r\n  getAllEntries(directoryReader) {\r\n    let entries = [];\r\n    let that = this;\r\n    const readEntries = function () {\r\n      directoryReader.readEntries((results) => {\r\n        if (!results.length) {\r\n          entries.sort();\r\n          that.readDirectory(entries);\r\n        } else {\r\n          entries = entries.concat(toArray(results));\r\n          readEntries();\r\n        }\r\n      }, errorHandler);\r\n    };\r\n    readEntries();\r\n  }\r\n\r\n  getDirectoryInfo = (entries) => {\r\n    this.setValue(entries);\r\n    entries.map((item) => {\r\n      if (item.isDirectory) {\r\n        console.log(item);\r\n        let directoryReader = item.createReader();\r\n        this.getAllEntries(directoryReader);\r\n      } else {\r\n        item.file(file => {\r\n          file.fullPath = item.fullPath\r\n          item.content = file;\r\n        })\r\n      }\r\n    });\r\n\r\n    return this.getValue();\r\n  };\r\n}\r\n\r\nexport default Directory;\r\n","/*\r\n * @Author: ecstAsy\r\n * @Date: 2022-01-13 15:45:41\r\n * @LastEditTime: 2022-01-17 17:32:25\r\n * @LastEditors: ecstAsy\r\n */\r\n\r\nconst Videos = [\r\n  'wmv', 'asf', 'asx', 'rm', 'rmvb', 'mp4', '3gp', 'mov', 'm4v', 'avi', 'dat', 'mkv', 'flv', 'vob'\r\n];\r\nconst Images = [\r\n  'png', 'jpg', 'jpeg'\r\n]\r\nconst Icons = [\r\n  'vue','sass','scss','css','jsx','md','js','json','svg','excel','file','word','ppt','music','html','video','img','zip','gif','exe','pdf','txt','wps'\r\n]\r\nconst findParent = (values) => {\r\n  values.map((item) => {\r\n    let parent = item.fullPath.split('/');\r\n    parent.pop();\r\n    item.parent = parent.join('/') || '/';\r\n    if (item.isDirectory) {\r\n      item.children = []\r\n      item.icon = 'file'\r\n    } else {\r\n      let itp = item.name.split('.').pop();\r\n      if (Videos.includes(itp)) {\r\n        itp = 'video'\r\n      } else if (Images.includes(itp)) {\r\n        itp = 'img'\r\n      } else if (itp.match(/htm/)){\r\n        itp = 'html'\r\n      } \r\n      item.icon = Icons.includes(itp) ? itp : 'default'\r\n    }\r\n\r\n  })\r\n}\r\n\r\nconst findChildren = (roots, values) => {\r\n  roots.map(item => {\r\n    if (item.children) {\r\n      item.children = values.filter(file => file.parent === item.fullPath);\r\n      findChildren(item.children, values);\r\n    }\r\n  })\r\n}\r\n\r\nconst findType = values => {\r\n  values.map((item) => {\r\n    if (item.isDirectory) {\r\n      item.icon = 'file'\r\n    } else {\r\n      let itp = item.name.split('.').pop();\r\n      if (Videos.includes(itp)) {\r\n        itp = 'video'\r\n      } else if (Images.includes(itp)) {\r\n        itp = 'img'\r\n      }\r\n      item.icon = itp\r\n    }\r\n  })\r\n}\r\n\r\nconst getTree = (values, type) => {\r\n  if (!values || !values.length) {\r\n    return false\r\n  }\r\n  let root = [{ name: '/', fullPath: '/', children: [], icon: 'file' }]\r\n  if (type === 'drop') {\r\n    findParent(values)\r\n    findChildren(root, values)\r\n  } else {\r\n    findType(values);\r\n    root[0].children = values;\r\n  }\r\n\r\n  return root\r\n}\r\n\r\n\r\nexport default getTree","/*\n * @Author: ecstAsy\n * @Date: 2022-01-18 14:23:54\n * @LastEditTime: 2022-01-18 14:49:06\n * @LastEditors: ecstAsy\n */\nconst Request = (url, params) => {\n  const { method, data } = params;\n  return new Promise((resolve, reject) => {\n    fetch(url, {\n      method: method || 'GET',\n      body: data,\n    })\n      .then(response => response.json())\n      .then(res => {\n        resolve(res)\n      })\n      .catch(error => reject(error))\n  })\n}\n\nexport default Request","/*\n * @Author: ecstAsy\n * @Date: 2022-01-18 14:10:54\n * @LastEditTime: 2022-01-18 14:29:23\n * @LastEditors: ecstAsy\n */\nimport Directory from './directory';\nimport getTree from './tree';\nimport Request from './Request';\n\n// 文件格式校验\nconst FileValidated = files => {\n  let valid = false;\n  if (files.length === 1 && !(files[0].name.match(/.zip/) || files[0].name.match(/index.htm/))) {\n    valid = true;\n  } else if (files.length > 1 && !files.find(item => item.name.match(/index.htm/))) {\n    valid = true;\n  }\n  return valid\n}\n\nexport {\n  Directory,\n  getTree,\n  Request,\n  FileValidated\n}","// extracted by mini-css-extract-plugin\nexport default {\"mask\":\"mask__eH69v\",\"loading_box\":\"loading_box__zmBls\",\"ring\":\"ring__+PdnS\",\"spinner\":\"spinner__3VM3i\"};","/*\n * @Author: ecstAsy\n * @Date: 2022-01-18 11:10:40\n * @LastEditTime: 2022-01-18 11:20:29\n * @LastEditors: ecstAsy\n */\n\nimport { h } from \"preact\";\nimport style from \"./index.css\";\n\nconst PageLoading = ({visible}) => {\n  return visible && (\n    <div class={style.mask}>\n      <div class={style.ring} />\n    </div>\n  )\n}\n\nexport default PageLoading","// extracted by mini-css-extract-plugin\nexport default {\"modal\":\"modal__FRo+3\",\"body\":\"body__JKq4M\",\"main\":\"main__+Hv9R\",\"header\":\"header__YVYwH\",\"content\":\"content__Grn0O\",\"footer\":\"footer__66oGB\",\"confirm\":\"confirm__1r-cg\"};","/*\n * @Author: ecstAsy\n * @Date: 2022-01-18 09:44:51\n * @LastEditTime: 2022-01-18 10:49:35\n * @LastEditors: ecstAsy\n */\nimport { h } from \"preact\";\nimport style from \"./index.css\";\n\nconst ToastModal = ({\n  visible,\n  url,\n  password,\n  onConfirm\n}) => {\n  return visible && (\n    <div class={style.modal}>\n      <div className={style.body}>\n        <div class={style.main}>\n          <div class={style.header}>\n            温馨提示\n          </div>\n          <div class={style.content}>\n            <p>访问地址：<span>{url}</span></p>\n            <p>修改密码：<span>{password}</span></p>\n          </div>\n          <div class={style.footer}>\n            <button class={style.confirm} onClick={onConfirm}>确认</button>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default ToastModal","// extracted by mini-css-extract-plugin\nexport default {\"mask\":\"mask__SwHDu\",\"content\":\"content__hBspW\",\"spinner\":\"spinner__RrROi\"};","/*\n * @Author: ecstAsy\n * @Date: 2022-01-18 11:24:33\n * @LastEditTime: 2022-01-18 14:56:30\n * @LastEditors: ecstAsy\n */\n\nimport { h } from \"preact\";\nimport style from \"./index.css\";\n\nconst PageToast = ({ visible, message, onClose }) => {\n  visible && setTimeout(() => {\n    onClose()\n  }, 3000)\n  return visible && (\n    <div class={style.mask}>\n      <div class={style.content}>\n        <span>\n          <i class='icon icon-error' />\n          { message }\n        </span>\n      </div>\n    </div>\n  )\n}\n\nexport default PageToast","// extracted by mini-css-extract-plugin\nexport default {\"DirectoryTree\":\"DirectoryTree__end2w\"};","/*\n * @Author: ecstAsy\n * @Date: 2022-01-18 14:35:38\n * @LastEditTime: 2022-01-18 14:36:43\n * @LastEditors: ecstAsy\n */\nimport { h } from \"preact\";\nimport style from \"./index.css\";\n\nconst FileItem = ({ row }) => (\n  <p>\n    <i class={`icon icon-${row.icon}`} />\n    <span>{row.name}</span>\n  </p>\n)\n\nconst TreeItem = ({ row }) => {\n  if (row.children) {\n    return (\n      <li>\n        <FileItem row={row} />\n        <ul>\n          {row.children.map(item => <TreeItem key={item.fullPath} row={item} />)}\n        </ul>\n      </li>\n    )\n  }\n  return (\n    <li>\n      <FileItem row={row} />\n    </li>\n  )\n}\n\nconst DirectoryTree = ({ trees }) => (\n  <ul class={style.DirectoryTree}>\n    {trees.map(item => <TreeItem key={item.fullPath} row={item} />)}\n  </ul>\n)\n\nexport default DirectoryTree ","// extracted by mini-css-extract-plugin\nexport default {\"home\":\"home__uRcqa\",\"form\":\"form__N9hpW\",\"upload\":\"upload__J0GDU\",\"toast\":\"toast__o-Egb\",\"input\":\"input__tyN32\",\"error\":\"error__qfBhC\",\"submit\":\"submit__vnIeA\"};","import { h } from \"preact\";\r\nimport { useState } from \"preact/hooks\";\r\nimport { Directory, getTree, Request, FileValidated } from '../../utils';\r\nimport { ToastModal, PageLoading, PageToast, DirectoryTree } from '../../components';\r\nimport style from \"./style.css\";\r\n\r\nconst Home = () => {\r\n  const [value, setValue] = useState([]);\r\n  const [isDrop, setIsDrop] = useState(false);\r\n  const [isError, setIsError] = useState(false);\r\n  const [dirs, setDirs] = useState([]);\r\n  const [trees, setTrees] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [password, setPassword] = useState(null);\r\n  const [modalProps, setModalProps] = useState({\r\n    visible: false,\r\n    url: null,\r\n    password: null,\r\n    onConfirm: () => Promise.all([\r\n      setModalProps({\r\n        ...modalProps,\r\n        visible: false,\r\n        url: null,\r\n        password: null,\r\n      }),\r\n      setValue([]),\r\n      setTrees([]),\r\n      setDirs([]),\r\n      setPassword(null)\r\n    ])\r\n  });\r\n  const [toastProps, setToastProps] = useState({\r\n    visible: false,\r\n    message: null,\r\n    onClose: () => setToastProps({ ...toastProps, visible: false, message: null }),\r\n  })\r\n  const drop = new Directory();\r\n\r\n  const onSubmit = async () => {\r\n    if (!value.length) {\r\n      return setToastProps({ ...toastProps, visible: true, message: '请选择要上传的文件！' })\r\n    }\r\n    await setLoading(true);\r\n    const form = new FormData();\r\n    dirs.length && form.append('dir', dirs);\r\n    password && form.append('password', password);\r\n    for (let i = 0; i < value.length; i++) {\r\n      form.append(`file[${value[i].fullPath}]`, value[i])\r\n    }\r\n    \r\n    const res = await Request('/api.php', {\r\n      method: 'POST',\r\n      data: form\r\n    });\r\n    await setLoading(false);\r\n    if (res.code) {\r\n      return setToastProps({ ...toastProps, visible: true, message: res.message })\r\n    }\r\n    return setModalProps({\r\n      ...modalProps,\r\n      visible: true,\r\n      ...res.data\r\n    })\r\n  };\r\n\r\n  const onChange = (e) => {\r\n    const fileList = e.target.files;\r\n    getFileTree(Object.values(fileList), 'change');\r\n    const valid = FileValidated(Object.values(fileList));\r\n    if (valid) return setIsError(true);\r\n    return Promise.all([\r\n      setDirs([]),\r\n      setValue(e.target.files),\r\n      setIsError(false)\r\n    ]);\r\n  };\r\n  const onDrop = async (e) => {\r\n    await Promise.all([\r\n      e.preventDefault(),\r\n      setIsError(false),\r\n      setValue([]),\r\n      setTrees([]),\r\n      setDirs([])\r\n    ])\r\n    const length = e.dataTransfer.items.length;\r\n    let entries = [];\r\n    for (let i = 0; i < length; i++) {\r\n      entries = [...entries, e.dataTransfer.items[i].webkitGetAsEntry()];\r\n    }\r\n    const directories = await drop.getDirectoryInfo(entries);\r\n    const valid = FileValidated(directories);\r\n    if (valid) return setIsError(true);\r\n    getFileTree(directories, 'drop');\r\n    let vs = [];\r\n    let ds = [];\r\n    directories.map(item => {\r\n      if (item.isFile) {\r\n        vs = [...vs, item.content];\r\n      } else {\r\n        ds = [...ds, item.fullPath];\r\n      }\r\n    })\r\n    return Promise.all([\r\n      setDirs(ds),\r\n      setValue(vs),\r\n      setIsError(false)\r\n    ]);\r\n  };\r\n\r\n  const openFile = () => {\r\n    document.getElementById(\"upload-input\").click();\r\n  };\r\n\r\n  const getFileTree = (values, type) => {\r\n    const data = getTree(values, type);\r\n    return setTrees(data);\r\n  }\r\n\r\n  return (\r\n    <div class={style.home}>\r\n      <h3> 文件上传 </h3>\r\n      <form class={style.form}>\r\n        <div\r\n          class={style.upload}\r\n          onClick={openFile}\r\n          onDrop={(e) => onDrop(e)}\r\n          onDragover={(e) => {\r\n            e.preventDefault();\r\n            setIsDrop(false);\r\n          }}\r\n          onDragStart={(e) => {\r\n            e.preventDefault();\r\n            setIsDrop(true);\r\n          }}\r\n        >\r\n          {!value.length ? <p class={style.toast}> <span>将文件拖到此处上传</span> </p> : <DirectoryTree trees={trees} />}\r\n          <input\r\n            class={style.input}\r\n            value={value}\r\n            id=\"upload-input\"\r\n            type=\"file\"\r\n            accept=\"*\"\r\n            multiple\r\n            onChange={onChange}\r\n            webkitdirectory={isDrop}\r\n            mozdirectort={isDrop}\r\n          />\r\n        </div>\r\n        <div class={style.error}>\r\n          <span> {isError && `请上传正确的文件类型！`} </span>\r\n        </div>\r\n        <label>\r\n          <span>修改密码：</span> <input value={password} placeholder=\"请输入修改密码\" onBlur={e => setPassword(e.target.value)} />\r\n        </label>\r\n      </form>\r\n      <button class={style.submit} onClick={onSubmit}>\r\n        提交\r\n      </button>\r\n      <ToastModal {...modalProps} />\r\n      <PageLoading visible={loading} />\r\n      <PageToast {...toastProps} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Home;\r\n"],"sourceRoot":""}