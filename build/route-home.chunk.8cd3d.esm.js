(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{"+1Jk":function(e,t,n){"use strict";function i(e,t){m.options.__h&&m.options.__h(f,e,d||t),d=0;var n=f.__H||(f.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function o(e){return d=1,function(e,t,n){var o=i(p++,2);return o.t=e,o.__c||(o.__=[n?n(t):s(void 0,t),function(e){var t=o.t(o.__[0],e);o.__[0]!==t&&(o.__=[t,o.__[1]],o.__c.setState({}))}],o.__c=f),o.__}(s,e)}function r(){var e;for(v.sort((function(e,t){return e.__v.__b-t.__v.__b}));e=v.pop();)if(e.__P)try{e.__H.__h.forEach(l),e.__H.__h.forEach(c),e.__H.__h=[]}catch(t){e.__H.__h=[],m.options.__e(t,e.__v)}}function l(e){var t=f,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),f=t}function c(e){var t=f;e.__c=e.__(),f=t}function s(e,t){return"function"==typeof t?t(e):t}function a(e){console.log(`FileSystem API error code: ${e.code}`)}function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.r(t);var p,f,b,m=n("hosL"),d=0,v=[],O=m.options.__b,j=m.options.__r,g=m.options.diffed,y=m.options.__c,w=m.options.unmount;m.options.__b=function(e){f=null,O&&O(e)},m.options.__r=function(e){j&&j(e),p=0;var t=(f=e.__c).__H;t&&(t.__h.forEach(l),t.__h.forEach(c),t.__h=[])},m.options.diffed=function(e){g&&g(e);var t=e.__c;t&&t.__H&&t.__H.__h.length&&(1!==v.push(t)&&b===m.options.requestAnimationFrame||((b=m.options.requestAnimationFrame)||function(e){var t,n=function(){clearTimeout(i),P&&cancelAnimationFrame(t),setTimeout(e)},i=setTimeout(n,100);P&&(t=requestAnimationFrame(n))})(r)),f=null},m.options.__c=function(e,t){t.some((function(e){try{e.__h.forEach(l),e.__h=e.__h.filter((function(e){return!e.__||c(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],m.options.__e(n,e.__v)}})),y&&y(e,t)},m.options.unmount=function(e){w&&w(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{l(e)}catch(e){t=e}})),t&&m.options.__e(t,n.__v))};var P="function"==typeof requestAnimationFrame;var D=class{constructor(){var e,t,n;n=e=>(this.setValue(e),e.map((e=>{if(e.isDirectory){console.log(e);let t=e.createReader();this.getAllEntries(t)}else e.file((t=>{t.fullPath=e.fullPath,e.content=t}))})),this.getValue()),(t="getDirectoryInfo")in(e=this)?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,this.value=[]}setValue(e){this.value=[...this.value,...e]}getValue(){return new Promise((e=>setTimeout((()=>e(this.value)),500)))}readDirectory(e){this.setValue(e),e.map((e=>{if(e.isDirectory){let t=e.createReader();this.getAllEntries(t)}else e.file((t=>{t.fullPath=e.fullPath,e.content=t}))}))}getAllEntries(e){let t=[],n=this;!function i(){e.readEntries((e=>{e.length?(t=t.concat(Array.prototype.slice.call(e||[],0)),i()):(t.sort(),n.readDirectory(t))}),a)}()}};const E=["wmv","asf","asx","rm","rmvb","mp4","3gp","mov","m4v","avi","dat","mkv","flv","vob"],k=["png","jpg","jpeg"],H=["vue","sass","scss","css","jsx","md","js","json","svg","excel","file","word","ppt","music","html","video","img","zip","gif","exe","pdf","txt","wps"],A=(e,t)=>{e.map((e=>{e.children&&(e.children=t.filter((t=>t.parent===e.fullPath)),A(e.children,t))}))};var T=(e,t)=>{if(!e||!e.length)return!1;let n=[{name:"/",fullPath:"/",children:[],icon:"file"}];return"drop"===t?((e=>{e.map((e=>{let t=e.fullPath.split("/");if(t.pop(),e.parent=t.join("/")||"/",e.isDirectory)e.children=[],e.icon="file";else{let t=e.name.split(".").pop();E.includes(t)?t="video":k.includes(t)?t="img":t.match(/htm/)&&(t="html"),e.icon=H.includes(t)?t:"default"}}))})(e),A(n,e)):((e=>{e.map((e=>{if(e.isDirectory)e.icon="file";else{let t=e.name.split(".").pop();E.includes(t)?t="video":k.includes(t)&&(t="img"),e.icon=t}}))})(e),n[0].children=e),n};var C=(e,t)=>{const{method:n,data:i}=t;return new Promise(((t,o)=>{fetch(e,{method:n||"GET",body:i}).then((e=>e.json())).then((e=>{t(e)})).catch((e=>o(e)))}))};const F=e=>{let t=!1;return 1!==e.length||e[0].name.match(/.zip/)||e[0].name.match(/index.htm/)?e.length>1&&!e.find((e=>e.name.match(/index.htm/)))&&(t=!0):t=!0,t};var S="mask__eH69v",q="ring__+PdnS";var x=({visible:e})=>e&&Object(m.h)("div",{class:S},Object(m.h)("div",{class:q})),V="modal__FRo+3",B="body__JKq4M",G="main__+Hv9R",I="header__YVYwH",J="content__Grn0O",R="footer__66oGB",z="confirm__1r-cg";var N=({visible:e,url:t,password:n,onConfirm:i})=>e&&Object(m.h)("div",{class:V},Object(m.h)("div",{className:B},Object(m.h)("div",{class:G},Object(m.h)("div",{class:I},"温馨提示"),Object(m.h)("div",{class:J},Object(m.h)("p",null,"访问地址：",Object(m.h)("span",null,t)),Object(m.h)("p",null,"修改密码：",Object(m.h)("span",null,n))),Object(m.h)("div",{class:R},Object(m.h)("button",{class:z,onClick:i},"确认"))))),$="mask__SwHDu",W="content__hBspW";var Y=({visible:e,message:t,onClose:n})=>(e&&setTimeout((()=>{n()}),3e3),e&&Object(m.h)("div",{class:$},Object(m.h)("div",{class:W},Object(m.h)("span",null,Object(m.h)("i",{class:"icon icon-error"}),t)))),K="DirectoryTree__end2w";const L=({row:e})=>Object(m.h)("p",null,Object(m.h)("i",{class:`icon icon-${e.icon}`}),Object(m.h)("span",null,e.name)),M=({row:e})=>e.children?Object(m.h)("li",null,Object(m.h)(L,{row:e}),Object(m.h)("ul",null,e.children.map((e=>Object(m.h)(M,{key:e.fullPath,row:e}))))):Object(m.h)("li",null,Object(m.h)(L,{row:e}));var U=({trees:e})=>Object(m.h)("ul",{class:K},e.map((e=>Object(m.h)(M,{key:e.fullPath,row:e})))),Q="home__uRcqa",X="form__N9hpW",Z="upload__J0GDU",ee="toast__o-Egb",te="input__tyN32",ne="error__qfBhC",ie="submit__vnIeA";t.default=()=>{const[e,t]=o([]),[n,i]=o(!1),[r,l]=o(!1),[c,s]=o([]),[a,_]=o([]),[h,p]=o(!1),[f,b]=o(null),[d,v]=o({visible:!1,url:null,password:null,onConfirm:()=>Promise.all([v(u(u({},d),{},{visible:!1,url:null,password:null})),t([]),_([]),s([]),b(null)])}),[O,j]=o({visible:!1,message:null,onClose:()=>j(u(u({},O),{},{visible:!1,message:null}))}),g=new D,y=(e,t)=>{const n=T(e,t);return _(n)};return Object(m.h)("div",{class:Q},Object(m.h)("h3",null," 文件上传 "),Object(m.h)("form",{class:X},Object(m.h)("div",{class:Z,onClick:()=>{document.getElementById("upload-input").click()},onDrop:e=>(async e=>{await Promise.all([e.preventDefault(),l(!1),t([]),_([]),s([])]);const n=e.dataTransfer.items.length;let i=[];for(let t=0;t<n;t++)i=[...i,e.dataTransfer.items[t].webkitGetAsEntry()];const o=await g.getDirectoryInfo(i);if(F(o))return l(!0);y(o,"drop");let r=[],c=[];return o.map((e=>{e.isFile?r=[...r,e.content]:c=[...c,e.fullPath]})),Promise.all([s(c),t(r),l(!1)])})(e),onDragover:e=>{e.preventDefault(),i(!1)},onDragStart:e=>{e.preventDefault(),i(!0)}},e.length?Object(m.h)(U,{trees:a}):Object(m.h)("p",{class:ee}," ",Object(m.h)("span",null,"将文件拖到此处上传")," "),Object(m.h)("input",{class:te,value:e,id:"upload-input",type:"file",accept:"*",multiple:!0,onChange:e=>{const n=e.target.files;y(Object.values(n),"change");return F(Object.values(n))?l(!0):Promise.all([s([]),t(e.target.files),l(!1)])},webkitdirectory:n,mozdirectort:n})),Object(m.h)("div",{class:ne},Object(m.h)("span",null," ",r&&"请上传正确的文件类型！"," ")),Object(m.h)("label",null,Object(m.h)("span",null,"修改密码：")," ",Object(m.h)("input",{value:f,placeholder:"请输入修改密码",onBlur:e=>b(e.target.value)}))),Object(m.h)("button",{class:ie,onClick:async()=>{if(!e.length)return j(u(u({},O),{},{visible:!0,message:"请选择要上传的文件！"}));await p(!0);const t=new FormData;c.length&&t.append("dir",c),f&&t.append("password",f);for(let n=0;n<e.length;n++)t.append(`file[${e[n].fullPath}]`,e[n]);const n=await C("/api.php",{method:"POST",data:t});return await p(!1),n.code?j(u(u({},O),{},{visible:!0,message:n.message})):v(u(u({},d),{},{visible:!0},n.data))}},"提交"),Object(m.h)(N,d),Object(m.h)(x,{visible:h}),Object(m.h)(Y,O))}}}]);
//# sourceMappingURL=route-home.chunk.8cd3d.esm.js.map